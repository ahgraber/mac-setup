### Aliases for bash and zsh
# x86 cli
alias rosetta="arch -x86_64 zsh"

alias aliasconfig="code ~/.aliases"
alias zshconfig="code ~/.zshrc"
# alias bashconfig="code ~/.bash_profile"
alias p10kconfig="code ~/.p10k.zsh"
alias codeconfig="code ~/Library/Application\ Support/Code/User/settings.json"
alias -s {py,pyc,ipynb,yml,yaml}=code

# clear terminal and clear buffer (scrollback)
alias clr="clear"
alias clrbuf="printf '\ec\e[3J'"
alias clear_buffer="printf '\ec\e[3J'"

# set ls / colorls aliases
command -v colorls >/dev/null 2>&1
if [[ $? -ne 0 ]]; then
  alias ls="ls -Gp"
  alias la="ls -AGp"
  alias ll="ls -lAGp"
  alias lt="tree -C -L 3"
else
  source $(dirname $(gem which colorls))/tab_complete.sh
  alias ls="colorls --sd"
  alias la="colorls -A --sd"
  alias ll="colorls -lA --sd"
  alias lt="colorls -A --tree=3"
fi

# show/hide filepaths in Finder
alias showpath="defaults write com.apple.finder _FXShowPosixPathInTitle -bool true; killall Finder"
alias hidepath="defaults write com.apple.finder _FXShowPosixPathInTitle -bool false; killall Finder"

# show/hide hidden folders
alias viewHidden="defaults write com.apple.finder AppleShowAllFiles -bool true | killall Finder"
alias showHidden="defaults write com.apple.finder AppleShowAllFiles -bool true | killall Finder"
alias hideHidden="defaults write com.apple.finder AppleShowAllFiles -bool false | killall Finder"

# dns and networking
alias flush="dscacheutil -flushcache && sudo killall -HUP mDNSResponder"
alias renew="sudo ipconfig set en0 BOOTP && sudo ipconfig set en0 DHCP"
alias ping="ping -c 3"
alias whatismyip='curl ifconfig.co'
alias externalip='curl ifconfig.co'

alias sleepless="pmset -g assertions | egrep '(PreventUserIdleSystemSleep|PreventUserIdleDisplaySleep)'"

# run with nbstrip_jq path/to/metadata.ipynb > path/to/stripped.ipynb
alias nbstrip_jq="jq --indent 1 \
    '(.cells[] | select(has(\"outputs\")) | .outputs) = []  \
    | (.cells[] | select(has(\"execution_count\")) | .execution_count) = null  \
    | .metadata = {\"language_info\": {\"name\": \"python\", \"pygments_lexer\": \"ipython3\"}} \
    | .cells[].metadata = {} \
    '"

function nbstrip_all_cwd {
    for nbfile in *.ipynb; do
        echo "$( nbstrip_jq $nbfile )" > $nbfile
    done
    unset nbfile
}
alias clean_ipynbs="nbstrip_all_cwd"

function cleanBranches {
  local -r deleteflag=${1:-"-d"}
  # remove link to nonexistent upstream branch
  git remote prune origin;
  # removes LOCAL branches that are deleted on (remote) origin
  git fetch -p;
  git branch -vv | grep ': gone]' | grep -v "\*" | awk '{ print $1 }' | xargs git branch ${deleteflag}
}
alias clean_branches=cleanBranches

alias docker_nuke=' \
  docker container prune -f ; \
  docker image prune -f ; \
  docker network prune -f ; \
  docker volume prune -f '

alias docker_rm_untagged='docker rmi $(docker images | grep "^<none>" | awk "{print $3}")'
